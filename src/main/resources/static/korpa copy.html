<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>BookStore</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <body class="p-3" data-bs-theme="dark">
        <nav class="navbar navbar-expand-lg">
            <h2 href="index.html">BookStore</h2>
            <ul class="navbar-nav mx-3"></ul>
            <ul class="navbar-nav">
            <li class="nav-item mx-3">
                <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item mx-3">
                <a class="nav-link" href="korpa.html">Moja korpa</a>
            </li>
            </ul>
        </nav>
        <div class="container-fluid">
            <h1 class="mb-4">Moja korpa</h1>
            <div id="cartItems" class="row row-cols-1 row-cols-md-6 row-cols-lg-6 g-4" style="max-height: 80vh; overflow-y: auto;"></div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const container = document.getElementById("cartItems");
                const cart = JSON.parse(localStorage.getItem("cart")) || [];
                const gBook = JSON.parse(localStorage.getItem('bookDetails'));
                console.log(cart);

                cart.forEach((book, index) => {
                    const card = document.createElement("div");
                    card.className = "col";
                    card.innerHTML = `
                    <div class="card h-100 text-bg-dark shadow">
                        <img src="${gBook.volumeInfo.imageLinks.thumbnail || 'https://via.placeholder.com/150'}" class="card-img-top" alt="${book.title}">
                        <div class="card-body">
                            <h5 class="card-title">${book.title}</h5>
                            <p class="card-text"><strong>Autor:</strong> ${book.author.name}</p>
                            <p class="card-text"><strong>Žanr:</strong> ${book.genre}</p>
                            <p class="card-text"><strong>Godina:</strong> ${book.year}</p>
                            <p></p>
                            <button class="btn btn-danger mt-2 remove-from-cart" data-index="${index}">Obriši iz korpe.</button>
                        </div>
                    </div>
                    `;
                    container.appendChild(card);
                });

                container.addEventListener("click", (e) => {
                    if (e.target.classList.contains("remove-from-cart")) {
                        const index = e.target.getAttribute("data-index");
                        cart.splice(index, 1);
                        localStorage.setItem("cart", JSON.stringify(cart));
                        location.reload();
                    }
                });
            });
        </script>
    </body>
</html>